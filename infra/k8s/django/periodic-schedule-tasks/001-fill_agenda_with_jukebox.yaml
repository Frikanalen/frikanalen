apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: fill-next-weeks-agenda-with-jukebox
spec:
  schedule: "00 23 * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: django
            image: frikanalen/django-backend
            args:
              - ./manage.py
              - fill_agenda_with_jukebox
              - -v
              - '2'
            env:
              - name: DJANGO_SETTINGS_MODULE
                value: fkweb.settings.production
              - name: DATABASE_HOST
                value: postgres.database
              - name: DATABASE_USER
                value: fkweb
              - name: DATABASE_NAME
                value: fkweb
              - name: ALLOWED_HOSTS
                value: frikanalen.no,fk.dev.local
              - name: SMTP_SERVER
                value: smtp.uio.no
            envFrom:
            - secretRef:
                name: postgres-secret-django
          restartPolicy: OnFailure
